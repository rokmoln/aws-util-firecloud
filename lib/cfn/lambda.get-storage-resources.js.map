{"version":3,"sources":["../../src/cfn/lambda.get-storage-resources.js"],"names":[],"mappings":"kIAAA,2E;;AAEO,IAAI,mBAAmB,GAAG,gBAAe;AAC9C,EAAA,MAD8C;AAE9C,EAAA,GAF8C;AAG9C,EAAA,KAH8C,EAAf;AAI9B;AACD;AACA,MAAI,IAAI,GAAG,OAAO,CAAC,MAAD,CAAlB;AACA,EAAA,IAAI,GAAG,IAAI,CAAC,UAAL,GAAkB,IAAI,CAAC,OAAvB,GAAiC,IAAxC;AACA,MAAI,UAAU,4CAAG,MAAM,IAAI,CAAC;AAC1B,QAAA,GAD0B;AAE1B,QAAA,GAAG,EAAE,MAFqB;AAG1B,QAAA,KAH0B,EAAD,CAAb,4IAAd;;;AAMA;AACA,EAAA,UAAU,CAAC,SAAX,GAAuB,yBAAE,MAAF,CAAS,UAAU,CAAC,SAApB,EAA+B,UAAS,QAAT,EAAmB,aAAnB,EAAkC;AACtF,YAAQ,QAAQ,CAAC,IAAjB;AACA,WAAK,sBAAL;AACA,WAAK,sBAAL;AACA,WAAK,8BAAL;AACA,WAAK,iBAAL;AACE;AACF;AACE,eAAO,KAAP,CAPF;;AASA,WAAO,IAAP;AACD,GAXsB,CAAvB;;AAaA,EAAA,UAAU,CAAC,SAAX,GAAuB,yBAAE,OAAF,CAAU,UAAU,CAAC,SAArB,EAAgC,UAAS,MAAT,EAAiB,GAAjB,EAAsB;AAC3E,WAAQ,GAAE,KAAM,GAAE,GAAI,EAAtB;AACD,GAFsB,CAAvB;;AAIA,SAAO,UAAU,CAAC,SAAlB;AACD,CAjCM,C","file":"lambda.get-storage-resources.js","sourcesContent":["import _ from 'lodash-firecloud';\n\nexport let getStorageResources = async function({\n  cfnDir,\n  env,\n  resNs\n}) {\n  // eslint-disable-next-line global-require\n  let main = require(cfnDir);\n  main = main.__esModule ? main.default : main;\n  let partialTpl = await main({\n    env,\n    dir: cfnDir,\n    resNs\n  });\n\n  // filter storage resources\n  partialTpl.Resources = _.pickBy(partialTpl.Resources, function(Resource, _ResourceName) {\n    switch (Resource.Type) {\n    case 'AWS::DynamoDB::Table':\n    case 'AWS::Kinesis::Stream':\n    case 'AWS::Kinesis::DeliveryStream':\n    case 'AWS::S3::Bucket':\n      break;\n    default:\n      return false;\n    }\n    return true;\n  });\n\n  partialTpl.Resources = _.mapKeys(partialTpl.Resources, function(_value, key) {\n    return `${resNs}${key}`;\n  });\n\n  return partialTpl.Resources;\n};\n\nexport default getStorageResources;\n"]}